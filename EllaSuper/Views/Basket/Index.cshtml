@using EllaSuper.ViewModels
@model List<BasketProductViewModel>
<main class="main">
    <div class="page page-cart">
        <div class="container container-1170">
            <div class="page-header">
                <div class="content">
                    <nav class="breadcrumb breadcrumb-left" aria-label="breadcrumbs">
                        <a class="link" asp-controller="home" asp-action="index">Home</a><span class="separate" aria-hidden="true">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M 7.75 1.34375 L 6.25 2.65625 L 14.65625 12 L 6.25 21.34375 L 7.75 22.65625 L 16.75 12.65625 L 17.34375 12 L 16.75 11.34375 Z"></path>
                            </svg>
                        </span>
                        <span>Shopping Cart</span>
                    </nav>
                    <h3 class="title uppercase">my cart</h3>
                </div>
            </div>  <!-- End header -->
            <div class="wrapper-content">
                <div class="haloCalculatorShipping">
                </div>  <!-- End haloCalculatorShipping -->
                <div class="cart-page-wrapper">
                    <div class="cart-items">
                        <div class="content-previewCart">
                            <div class="cart-rowHeading uppercase">
                                <h3 class="cart-rowItem cart-product">product</h3>
                                <h3 class="cart-rowItem cart-price">price</h3>
                                <h3 class="cart-rowItem cart-qty">qty</h3>
                                <h3 class="cart-rowItem cart-total">total</h3>
                            </div>
                            <div class="cart-rowContent">
                                <ul class="previewCartList list-unstyled">
                                    @foreach (var item in Model)
                                    {
                                        <li id=@(item.Id+"tbody") class="previewCartItem clearfix">
                                            <input type="hidden" value="@item.Id" />
                                            <a class="previewCartItem-image">
                                                <img src="assets/images/product/@item.Images" alt="Ella Product">
                                            </a>
                                            <div class="previewCartItem-content">
                                                <a class="previewCartItem-name link-underline">
                                                    <span class="text">"@item.Description"</span>
                                                </a>
                                                <div class="previewCartItem-options">
                                                    <span class="previewCartItem-variant">@item.size</span>
                                                </div>
                                                <div class="card-vendor">
                                                    <a title="" tabindex="0">@item.Name</a>
                                                </div>
                                            </div>
                                            <div class="previewCartItem-price">
                                                <span class="price">
                                                    <span class="money">$@item.DiscountPrice</span>
                                                </span>
                                            </div>
                                            <div class="quantity">
                                                <div class="previewCartItem-qty">

                                                    <input class="form-input quantity" id="product-quality" min="1" value="@item.Count" type="number">

                                                </div>
                                            </div>
                                            <div class="previewCartTotals subTotal clearfix">
                                                <div class="item previewCartTotals-value">
                                                    <span class="money">$@(item.DiscountPrice * item.Count)</span>
                                                </div>
                                            </div>
                                            <a id="remove-from-cart" class="previewCartItem-remove" data-cart-remove="" data-cart-remove-id="39504901341274" data-line="39504901341274:6317036bb7e9264dc5231958196b34f1" aria-label="Remove Naminos demen dincidunto - Cadetblue / XS / Option 1">
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                                                    <path d="M 38.982422 6.9707031 A 2.0002 2.0002 0 0 0 37.585938 7.5859375 L 24 21.171875 L 10.414062 7.5859375 A 2.0002 2.0002 0 0 0 8.9785156 6.9804688 A 2.0002 2.0002 0 0 0 7.5859375 10.414062 L 21.171875 24 L 7.5859375 37.585938 A 2.0002 2.0002 0 1 0 10.414062 40.414062 L 24 26.828125 L 37.585938 40.414062 A 2.0002 2.0002 0 1 0 40.414062 37.585938 L 26.828125 24 L 40.414062 10.414062 A 2.0002 2.0002 0 0 0 38.982422 6.9707031 z"></path>
                                                </svg>
                                            </a>
                                        </li>
                                    }
                                </ul>
                            </div>
                        </div>
                        <div class="gift-card-container">
                            <a href="#" class="gift-card"><svg aria-hidden="true" focusable="false" data-prefix="fal" data-icon="gift" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-gift fa-w-16 fa-3x"><path fill="currentColor" d="M464 144h-39.3c9.5-13.4 15.3-29.9 15.3-48 0-44.1-33.4-80-74.5-80-42.3 0-66.8 25.4-109.5 95.8C213.3 41.4 188.8 16 146.5 16 105.4 16 72 51.9 72 96c0 18.1 5.8 34.6 15.3 48H48c-26.5 0-48 21.5-48 48v96c0 8.8 7.2 16 16 16h16v144c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V304h16c8.8 0 16-7.2 16-16v-96c0-26.5-21.5-48-48-48zm-187.8-3.6c49.5-83.3 66-92.4 89.3-92.4 23.4 0 42.5 21.5 42.5 48s-19.1 48-42.5 48H274l2.2-3.6zM146.5 48c23.4 0 39.8 9.1 89.3 92.4l2.1 3.6h-91.5c-23.4 0-42.5-21.5-42.5-48 .1-26.5 19.2-48 42.6-48zM192 464H80c-8.8 0-16-7.2-16-16V304h128v160zm0-192H32v-80c0-8.8 7.2-16 16-16h144v96zm96 192h-64V176h64v288zm160-16c0 8.8-7.2 16-16 16H320V304h128v144zm32-176H320v-96h144c8.8 0 16 7.2 16 16v80z" class=""></path></svg></a>
                            <div class="content-gift desc text-left uppercase">DO YOU WANT A GIFT WRAP? <span class="only">ONLY FOR $10<span></span></span></div>
                            <a class="button button-2">Add</a>
                        </div>
                        <div class="cart-note form-field">
                            <label class="form-label desc" for="cart-note">Additional Comments</label>
                            <textarea class="form-input form-input-placeholder" name="note" id="cart-note" placeholder="Special instruction for seller..."></textarea>
                        </div>
                        <div class="cart-securityImage">
                            <div class="security-content">
                                <a href="#"><svg width="24px" height="24px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin" class="icon jam-shield-check-f"><path d="M.649 3.322L8 .565l7.351 2.757a1 1 0 0 1 .649.936v4.307c0 3.177-1.372 6.2-3.763 8.292L8 20.565l-4.237-3.708A11.019 11.019 0 0 1 0 8.565V4.258a1 1 0 0 1 .649-.936zm6.29 7.51L5.525 9.42a1 1 0 1 0-1.414 1.414l2.121 2.121a1 1 0 0 0 1.414 0l4.243-4.243a1 1 0 1 0-1.414-1.414l-3.536 3.536z"></path></svg></a>
                                <span class="desc">
                                    Secure Shopping Guarantee
                                </span>
                            </div>
                            <ul class="list-unstyled">
                                <li><a href="#"><img src="assets/images/Pages/page-cart/cart-security-1.png" loading="lazy" alt="Ella security"></a></li>
                                <li><a href="#"><img src="assets/images/Pages/page-cart/cart-security-3.png" loading="lazy" alt="Ella security"></a></li>
                                <li><a href="#"><img src="assets/images/Pages/page-cart/cart-security-2.png" loading="lazy" alt="Ella security"></a></li>
                                <li><a href="#"><img src="assets/images/Pages/page-cart/cart-security-4.png" loading="lazy" alt="Ella security"></a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="cart-content-item cart-total">
                        <form action="http://themes.halothemes.com/cart/add" method="post" novalidate="">
                            <div class="content-cart-right">
                                <div class="list-unstyled">
                                    <h3 class="cart--totals-title desc">Order Summary </h3>
                                    <ul class="list-unstyled">
                                        <li class="cart-total-subtotal">
                                            <div class="item previewCartTotals-label">
                                                Subtotal:
                                            </div>
                                            <div class="item previewCartTotals-value">
                                                <span class="money">$317.00</span>
                                            </div>
                                        </li>
                                        <li class="cart-total-shipping">
                                            <div class="cart-total-label">
                                                <span class="desc">Get Shipping Estimate:</span>
                                            </div>
                                            <div class="cart-nation">
                                                <div class="shipping-wrapper">
                                                    <div class="shipping-container" data-dropdown-toggle>
                                                        <div class="disclosure">
                                                            <button type="button" class="disclosure__button dropdown-toggle">
                                                                <span class="text">United States</span>
                                                                <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 551.13 551.13" height="512" viewBox="0 0 551.13 551.13" width="512"><path d="m275.565 361.679-223.897-223.896h-51.668l275.565 275.565 275.565-275.565h-51.668z"></path></svg>
                                                            </button>
                                                        </div>
                                                        <div class="dropdown-shipping halo-dropdown">
                                                            <ul class="disclosure__list">
                                                                <li><a class="dropdown-item" href="#">Afghanistan</a></li>
                                                                <li><a class="dropdown-item" href="#">Armenia</a></li>
                                                                <li><a class="dropdown-item" href="#">Ascension Island</a></li>
                                                                <li><a class="dropdown-item" href="#">Austria</a></li>
                                                                <li><a class="dropdown-item" href="#">Bosnia & Herzegovina</a></li>
                                                                <li><a class="dropdown-item" href="#">Botswana</a></li>
                                                                <li><a class="dropdown-item" href="#">Brazil</a></li>
                                                                <li><a class="dropdown-item" href="#">British Indian Ocean Territory</a></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="cart-city">
                                                <div class="shipping-wrapper">
                                                    <div class="shipping-container" data-dropdown-toggle>
                                                        <div class="disclosure">
                                                            <button type="button" class="disclosure__button dropdown-toggle">
                                                                <span class="text">Alabama</span>
                                                                <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 551.13 551.13" height="512" viewBox="0 0 551.13 551.13" width="512"><path d="m275.565 361.679-223.897-223.896h-51.668l275.565 275.565 275.565-275.565h-51.668z"></path></svg>
                                                            </button>
                                                        </div>
                                                        <div class="dropdown-shipping halo-dropdown">
                                                            <ul class="disclosure__list">
                                                                <li><a class="dropdown-item" href="#">Alaska</a></li>
                                                                <li><a class="dropdown-item" href="#">American Samoa</a></li>
                                                                <li><a class="dropdown-item active" href="#">Alabama</a></li>
                                                                <li><a class="dropdown-item" href="#">Ascension Island</a></li>
                                                                <li><a class="dropdown-item" href="#">Arizona</a></li>
                                                                <li><a class="dropdown-item" href="#">Arkansas</a></li>
                                                                <li><a class="dropdown-item" href="#">Hawaii</a></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group" id="address">
                                                    <input type="text" id="address_zip" value="35004" class="field__input" name="address[zip]">
                                                </div>
                                            </div>
                                            <div id="get-rates-container">
                                                <input type="submit" class="styled-submit button button-2" value="Calculate Shipping">
                                            </div>
                                            <div class="sub-shipping">
                                                <div class="message-shipping">
                                                    <ul>
                                                        <li class="desc">There is one shipping rate available for 35004, United States.</li>
                                                        <li class="standard">
                                                            <span class="doc"></span>
                                                            <span class="standard-item">Standard Shipping at $10.00 USD</span>
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div class="coupon">
                                                    <div class="desc">Coupon Code:</div>
                                                    <input type="text" class="styled-input field__input" name="address[zip]">
                                                    <div class="sub-desc">Coupon code will be applied on the checkout page</div>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="cart-total-grandtotal">
                                            <div class="item previewCartTotals-label">
                                                Total:
                                            </div>
                                            <div class="item previewCartTotals-value">
                                                <span class="money">$506.00</span>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <div class="previewCartAction text-left">
                                    <div class="previewCartCheckbox global-checkbox">
                                        <input class="global-checkbox--input" type="checkbox" name="cart_conditions" id="cart_conditions">
                                        <label class="global-checkbox--label form-label--checkbox" for="cart_conditions">I agree with the</label>
                                        <a href="javascript:void(0)" data-term-condition="">Terms Conditions</a>
                                    </div>
                                    <div class="previewCartGroup">
                                        <button class="button button-1 button-checkout" disabled="disabled">Proceed To Checkout</button>
                                        <a class="button button-2 button-view-cart text-center" href="#">Continue Shopping</a>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>  <!-- End cart-product -->
                <div class="halo-block halo-product-block cart-page-product" data-product-carousel data-item-to-show="4" data-item-dots="false" data-item-arrows="true" data-item-dots-mb="true" data-item-arrows-mb="false">
                    <div class="title-product-cart">
                        Customers Who Bought This Item Also Bought
                    </div>
                    <div class="halo-block-content product-carousel">
                        <div class="row">
                            @foreach (var item in Model)
                            {
                                <div class="product-item col-6 col-md-4 col-lg-3">
                                    <div class="product-card">
                                        <div class="product-card-top">
                                            <div class="product-card-media">
                                                <input type="hidden" value="@item.Id" />
                                                <a asp-controller="product" asp-action="details" asp-route-id="@item.Id" class="animate-scale image image-adapt" style="padding-bottom: 133.33333333333334%">
                                                    <img src="~/assets/images/product/@item.Images" alt="Halo Product">
                                                </a>
                                                <div class="card-product__group group-right">
                                                    <div class="card-product__group-item card-wishlist">
                                                        <a class="card-icon" id="productLink" style="font-size:15px">
                                                            <input type="hidden" id="productId" value="@item.Id" />
                                                            <i id=@("favorite"+item.Id) class="fa-regular fa-heart"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                                <div class="card-action">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="product-card-bottom">
                                            <div class="product-card-information text-center">
                                                <span class="text">@item.Name</span>
                                                <div class="card-summary card-grid-hide">
                                                    <a id="add-product-to-cart">Add To Cart</a>
                                                </div>
                                                <div class="card-price">
                                                    <div class="price-item">
                                                        <span class="money">$@item.DiscountPrice</span> <del class="money">$@item.Price</del>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            }

                        </div>
                    </div>
                </div>
            </div>
        </div>  <!-- End wrapper content -->
    </div>
    </div>
</main><!-- END: main -->
<link rel="stylesheet" href="~/assets/sass/pages/page-cart.css">
@section Scripts{
    <script>

        $(document).on('click', '#remove-from-cart', function () {
            var productId = $(this).parent().children().val();
            console.log(productId)
            $.ajax({
                type: "POST",
                url: "/Basket/DeleteProductBasket",
                data: { productId: productId },
                success: function () {
                    $("#" + productId + "tbody").remove();
                },
                Error: function () {
                    alert("Somthing Wrong");
                }
            });

        });

        $(document).on('change', '#product-quality', function () {
            var productId = $(this).parent().parent().parent().children().val();
            var count = $(this).val();
            //var price = $("#product-price").attr("data-id");
            // var totalPrice = price * count;
           
           

            $.ajax({
                type: "POST",
                url: "/Basket/ChangeProductQuality",
                data: { productId: productId, count: count },
                success: function () {
                    //$("#" + "product-total-price" + productId).html(totalPrice);
                },
                Error: function () {
                    alert("Somthing Wrong");
                }
            });

        });
    </script>
}